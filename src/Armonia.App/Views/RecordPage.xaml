<UserControl x:Class="Armonia.App.Views.RecordPage"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:local="using:Armonia.App.Views"
             xmlns:views="clr-namespace:Armonia.App.Views"
             Background="#cfb29a">

        <UserControl.Resources>

            <!-- Base icon style -->
            <Style x:Key="IconButtonStyle" TargetType="Button">
                <Setter Property="Background" Value="Transparent"/>
                <Setter Property="BorderThickness" Value="0"/>
                <Setter Property="Cursor" Value="Hand"/>
                <Setter Property="FontFamily" Value="Segoe UI Emoji"/>
                <Setter Property="FontSize" Value="24"/>
                <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
                <Setter Property="OverridesDefaultStyle" Value="True"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Button">
                            <Border CornerRadius="25"
                                    Background="{TemplateBinding Background}">
                                <ContentPresenter HorizontalAlignment="Center"
                                                VerticalAlignment="Center"
                                                TextElement.Foreground="{TemplateBinding Foreground}"/>
                            </Border>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <!-- ðŸ”´ Record -->
            <Style x:Key="RecordButtonStyle" TargetType="Button" BasedOn="{StaticResource IconButtonStyle}">
                <Setter Property="Width" Value="50"/>
                <Setter Property="Height" Value="50"/>
                <!--radial gradient-->
                 <Setter Property="Foreground">
                    <Setter.Value>
                        <RadialGradientBrush GradientOrigin="0.45,0.4"
                                            Center="0.5,0.5"
                                            RadiusX="0.7"
                                            RadiusY="0.7">
                            <!-- center -->
                            <GradientStop Color="#ff2b00" Offset="0.0"/>
                            <GradientStop Color="#d40000" Offset="0.3"/>
                            <GradientStop Color="#8a0000" Offset="0.6"/>
                            <!-- outer -->
                            <GradientStop Color="#440000" Offset="1.0"/>
                        </RadialGradientBrush>
                    </Setter.Value>
                </Setter>
                <!-- dropdown -->
                <Setter Property="Effect">
                    <Setter.Value>
                        <DropShadowEffect BlurRadius="10"
                                        ShadowDepth="2"
                                        Opacity="0.6"
                                        Color="#330000"/>
                    </Setter.Value>
                </Setter>
                <!-- make circle brighter on hover -->
                <Style.Triggers>
                    <Trigger Property="IsMouseOver" Value="True">
                        <Setter Property="Foreground">
                            <Setter.Value>
                                <RadialGradientBrush GradientOrigin="0.45,0.4"
                                                    Center="0.5,0.5"
                                                    RadiusX="0.9"
                                                    RadiusY="0.9">
                                                    <!--Everything is same but RadiusX/Y-->
                                    <GradientStop Color="#ff2b00" Offset="0.0"/>
                                    <GradientStop Color="#d40000" Offset="0.3"/>
                                    <GradientStop Color="#8a0000" Offset="0.6"/>
                                    <GradientStop Color="#440000" Offset="1.0"/>
                                </RadialGradientBrush>
                            </Setter.Value>
                        </Setter>
                    </Trigger>
                </Style.Triggers>    
            </Style>

            <!-- â¸ Pause -->
            <Style x:Key="PauseButtonStyle" TargetType="Button" BasedOn="{StaticResource IconButtonStyle}">
                <Setter Property="Foreground" Value="Black"/>
                <Setter Property="Background" Value="#FFE0E0E0"/>
                <Setter Property="Effect">
                    <Setter.Value>
                        <DropShadowEffect ShadowDepth="2" BlurRadius="4" Opacity="0.3" Color="Gray"/>
                    </Setter.Value>
                </Setter>
            </Style>

            <!-- ðŸ” Replay -->
            <Style x:Key="ReplayButtonStyle" TargetType="Button" BasedOn="{StaticResource IconButtonStyle}">
                <Setter Property="Foreground" Value="#1c0d08e6"/>
                <Setter Property="Background" Value="#1c0d08e6"/>
                <Setter Property="Effect">
                    <Setter.Value>
                        <DropShadowEffect ShadowDepth="2" BlurRadius="4" Opacity="0.3" Color="Black"/>
                    </Setter.Value>
                </Setter>
            </Style>

            <!-- â¹ Stop -->
            <Style x:Key="StopButtonStyle" TargetType="Button" BasedOn="{StaticResource IconButtonStyle}">
                <Setter Property="Foreground" Value="White"/>
                <Setter Property="Background" Value="#FF8B0000"/>
                <Setter Property="Effect">
                    <Setter.Value>
                        <DropShadowEffect ShadowDepth="2" BlurRadius="5" Opacity="0.35" Color="Black"/>
                    </Setter.Value>
                </Setter>
            </Style>

            <!-- âž¡ Push -->
            <Style x:Key="PushButtonStyle" TargetType="Button" BasedOn="{StaticResource IconButtonStyle}">
                <Setter Property="Foreground" Value="Black"/>
                <Setter Property="Background" Value="#FFF4D35E"/>
                <Setter Property="Effect">
                    <Setter.Value>
                        <DropShadowEffect ShadowDepth="3" BlurRadius="5" Opacity="0.35" Color="Goldenrod"/>
                    </Setter.Value>
                </Setter>
            </Style>

        </UserControl.Resources>


    <Grid Margin="10">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="3*" /> <!-- Recorder -->
            <ColumnDefinition Width="Auto" /> <!-- Splitter left -->
            <ColumnDefinition Width="2*" /> <!-- Composer -->
            <ColumnDefinition Width="Auto" /> <!-- Splitter right -->
            <ColumnDefinition Width="3*" /> <!-- Lyrics -->
        </Grid.ColumnDefinitions>

        <!-- set left section -->
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="*" />   <!-- Recorder Section -->
                <RowDefinition Height="*" />   <!-- MIDI Section -->
            </Grid.RowDefinitions>

             <!-- Recorder Section -->
        <Border Grid.Row="0" Background="#e7d5c0" CornerRadius="10" Padding="20,20,20,0" Margin="5,5,10,6">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>  <!-- ðŸŽ™ Header -->
                    <RowDefinition Height="Auto"/>  <!-- Input selector -->
                    <RowDefinition Height="*" />    <!-- Waveform + Controls -->
                </Grid.RowDefinitions>

                <!-- ðŸŽ™ Record Header -->
                <StackPanel Grid.Row="0" 
                            Orientation="Horizontal"
                            HorizontalAlignment="Center"
                            Margin="0,0,0,15">
                    <TextBlock Text="ðŸŽ™"
                            FontSize="22"
                            Margin="0,0,6,0"/>
                    <TextBlock Text="Record"
                            FontSize="22"
                            FontWeight="Bold"
                            Foreground="#3b2718"
                            FontFamily="Georgia"/>
                </StackPanel>

                <!-- Input Selector -->
                <StackPanel Grid.Row="1"
                            Orientation="Horizontal"
                            HorizontalAlignment="Center"
                            Margin="0,0,0,15">
                    <TextBlock Text="Input: "
                            FontFamily="Georgia"
                            FontSize="16"
                            Foreground="#3b2718"
                            Margin="0,0,5,0"/>
                    <ComboBox x:Name="InputSelector"
                            Width="90"
                            FontFamily="Georgia"
                            Background="#f6eadc"
                            Foreground="#3b2718">
                        <ComboBoxItem Content="Mic" IsSelected="True"/>
                        <ComboBoxItem Content="Acoustic"/>
                        <ComboBoxItem Content="Keyboard"/>
                        <ComboBoxItem Content="Other"/>
                    </ComboBox>
                </StackPanel>

                <!-- Waveform & Buttons -->
        <Grid Grid.Row="2" Margin="0,0,0,10">
            <Grid.RowDefinitions>
                <RowDefinition Height="0.8*" />   <!-- Waveform -->
                <RowDefinition Height="0.2*"/> <!-- Buttons -->
            </Grid.RowDefinitions>

            <Border Grid.Row="0"
                    Height="80"
                    Background="#000000"
                    ClipToBounds="True"
                    CornerRadius="6"
                    BorderBrush="#3b2718"
                    BorderThickness="1"
                    Margin="20,10,20,40"> <!--Waveform Display-->

                <Grid>
                    <!-- Canvas for waveform -->
                    <Canvas x:Name="WaveformCanvas"
                            Margin="35,10,10,25"
                            Background="Transparent" />

                    <!-- X-Axis (time labels) -->
                    <Canvas x:Name="TimeAxisCanvas"
                            VerticalAlignment="Bottom"
                            Height="20"
                            Margin="20,0,10,0"/>

                    <!-- Arrow showing current draw position -->
                    <Canvas x:Name="CursorContainer"
                            VerticalAlignment="Top"
                            HorizontalAlignment="Left"
                            IsHitTestVisible="False"
                            Margin="0,0,0,0">
                        <Polygon x:Name="CursorArrow"
                                Fill="#cfb29a"
                                Points="0,0 -10,0 -5,10"
                                Canvas.Left="3"
                                Canvas.Top="0"/>
                    </Canvas>
                </Grid>
            </Border>


                <!-- Buttons -->
                <Grid  VerticalAlignment="Bottom" Margin="40,0,40,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" /> <!--Grid.Row="1" -->
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                     <!-- Left Control (Record / Pause / Replay)âºâ–¶ -->
                    <Button x:Name="LeftButton"
                            Grid.Column="0"
                            Style="{StaticResource RecordButtonStyle}"
                            Content="âº"
                            FontSize="35"
                            FontFamily="Segoe UI Symbol"
                            BorderThickness="0"
                            Width="40"
                            Height="40"
                            Background="Transparent"
                            Click="LeftButton_Click"
                            HorizontalAlignment="Left"
                            VerticalAlignment="Center"
                            Margin="-5,0,0,0">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border BorderThickness="{TemplateBinding BorderThickness}"
                                        Background="{TemplateBinding Background}"
                                        BorderBrush="{TemplateBinding BorderBrush}"
                                        CornerRadius="30">
                                    <ContentPresenter HorizontalAlignment="Center"
                                                    VerticalAlignment="Center"
                                                    RecognizesAccessKey="True" />
                                </Border>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>

                    <!-- Right Control (Stop / Push) -->
                    <Button x:Name="RightButton"
                            Grid.Column="1"
                            Style="{StaticResource StopButtonStyle}"
                            Content="â¹"
                            FontSize="26"
                            Foreground="Gray"
                            BorderBrush="Black"
                            FontFamily="Segoe UI Symbol"
                            BorderThickness="0"
                            Width="40"
                            Height="40"
                            Background="Transparent"
                            Click="RightButton_Click"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Center"
                            Margin="0,0,0,0"
                            IsEnabled="False">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border BorderThickness="{TemplateBinding BorderThickness}"
                                        Background="{TemplateBinding Background}"
                                        BorderBrush="{TemplateBinding BorderBrush}"
                                        CornerRadius="30">
                                    <ContentPresenter HorizontalAlignment="Center"
                                                    VerticalAlignment="Center"
                                                    RecognizesAccessKey="True" />
                                </Border>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>
                </Grid>
                </Grid>
            </Grid>
        </Border>

        <!-- ðŸŽ¹ MIDI Section -->
        <Border Grid.Row="1" Background="#decbb5" CornerRadius="10" Padding="20" Margin="5,6,10,5">
            <StackPanel>
                <TextBlock Text="ðŸŽ¹ MIDI Instruments"
                           FontSize="20"
                           FontWeight="Bold"
                           Foreground="#3b2718"
                           FontFamily="Georgia"
                           HorizontalAlignment="Center"
                           Margin="0,0,0,10"/>

                <Expander Header="Select MIDI Instrument"
                          Background="#f6eadc"
                          Foreground="#3b2718"
                          FontFamily="Georgia">
                    <StackPanel Margin="10">
                        <ComboBox x:Name="MidiInstrumentSelector"
                                  Background="#fffaf3"
                                  Foreground="#3b2718"
                                  FontFamily="Georgia"
                                  Margin="0,5,0,10">
                            <ComboBoxItem Content="Piano" />
                            <ComboBoxItem Content="Guitar" />
                            <ComboBoxItem Content="Drums" />
                            <ComboBoxItem Content="Violin" />
                            <ComboBoxItem Content="Custom..." />
                        </ComboBox>

                        <Button Content="âž• Add Instrument to Composer"
                                Width="240"
                                Height="40"
                                FontSize="14"
                                FontFamily="Georgia"
                                Foreground="White"
                                Background="#5a3e2b"
                                BorderThickness="0"
                                Click="AddMidiInstrument_Click"/>
                    </StackPanel>
                </Expander>
            </StackPanel>
        </Border>
    </Grid>

        <!-- Splitter between Recorder and Composer -->
        <GridSplitter Grid.Column="1"
                      Width="5"
                      HorizontalAlignment="Center"
                      Background="#b79b85"
                      ShowsPreview="False"
                      DragIncrement="1"
                      ResizeDirection="Columns"
                      Cursor="SizeWE"/>

        <!-- ðŸŽ¼ Composer Section -->
        <views:ComposerControl x:Name="ComposerSection" 
                               Grid.Column="2"
                               HorizontalAlignment="Stretch"
                               VerticalAlignment="Stretch"
                               Margin="0,5,0,5"/>

        <!-- Splitter between Composer and Lyrics -->
        <GridSplitter Grid.Column="3"
                      Width="5"
                      HorizontalAlignment="Center"
                      Background="#b79b85"
                      ShowsPreview="False"
                      DragIncrement="1"
                      ResizeDirection="Columns"
                      Cursor="SizeWE"/>

        <!-- ðŸ“ Lyrics Section -->
        <Border Grid.Column="4" Background="#f8efe3" CornerRadius="10" Padding="10" Margin="10,5,5,5">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <TextBlock Text="ðŸ“ Lyrics"
                           HorizontalAlignment="Center"
                           FontSize="22"
                           FontWeight="Bold"
                           Foreground="#3b2718"
                           Margin="0,0,0,10"/>

                <Grid Grid.Row="1">
                    <TextBox x:Name="LyricsEditor"
                            AcceptsReturn="True"
                            VerticalScrollBarVisibility="Auto"
                            TextWrapping="Wrap"
                            Background="#fffaf3"
                            Foreground="#2c1a0c"
                            FontFamily="Georgia"
                            FontSize="16"
                            BorderThickness="1"
                            BorderBrush="#a48a74"
                            TextChanged="LyricsEditor_TextChanged"/>

                    <!-- ðŸ“‚ Open Button -->
                    <Button x:Name="OpenLyricsButton"
                            Content="ðŸ“‚"
                            Width="34" Height="34"
                            ToolTip="Open lyrics file"
                            Background="#decbb5"
                            BorderThickness="0"
                            Foreground="#2c1a0c"
                            FontSize="18"
                            HorizontalAlignment="Left"
                            VerticalAlignment="Bottom"
                            Margin="8,0,0,8"
                            Click="OpenLyricsButton_Click"/>

                             <!-- ðŸ’¾ Save Button -->
                    <Button x:Name="SaveLyricsButton"
                            Content="ðŸ’¾"
                            Width="34" Height="34"
                            ToolTip="Save lyrics file"
                            Background="#decbb5"
                            BorderThickness="0"
                            Foreground="#2c1a0c"
                            FontSize="18"
                            HorizontalAlignment="Left"
                            VerticalAlignment="Bottom"
                            Margin="48,0,0,8"
                            Click="SaveLyricsButton_Click"/>
                </Grid>
            </Grid>
        </Border>

         <!-- ðŸŒ€ Floating Toolbar Overlay -->
    <Canvas x:Name="ToolbarCanvas"
            HorizontalAlignment="Left"
            VerticalAlignment="Top"
            Panel.ZIndex="999"
            Margin="5">

        <!-- Toggle Button -->
        <Button x:Name="ToolbarToggle"
                Content="â˜°"
                FontSize="25"
                Margin="5"
                Style="{StaticResource IconButtonStyle}"
                Click="ToggleToolbar_Click"
                Width="40" Height="40"
                Background="#cfb29a"
                BorderThickness="0">
            <Button.Template>
                <ControlTemplate TargetType="Button">
                    <Border CornerRadius="10"
                            Background="{TemplateBinding Background}">
                        <ContentPresenter 
                         HorizontalAlignment="Center"
                         VerticalAlignment="Center"
                         TextElement.Foreground="{TemplateBinding Foreground}"/>
                    </Border>
                </ControlTemplate>
            </Button.Template>
            <!-- Add in traaansform -->
            <Button.RenderTransform>
                <TransformGroup>
                    <ScaleTransform x:Name="MenuScaleTransform" ScaleX="1" ScaleY="1"/>
                    <TranslateTransform x:Name="MenuTranslateTransform" Y="0"/>
                </TransformGroup>
            </Button.RenderTransform>
        </Button>   

        <!-- Hidden Toolbar (Quarter Circle) -->
        <Border x:Name="Toolbar"
                Width="98" Height="98"
                Visibility="Collapsed"
                CornerRadius="0,0,180,0"
                Background="#cfb29a"
                Opacity="1"
                MouseDown="Toolbar_Click"
                RenderTransformOrigin="0,0"
                Canvas.Left="-5" Canvas.Top="-5">
                
            <Border.RenderTransform>
                <ScaleTransform ScaleX="0" ScaleY="0"/>
            </Border.RenderTransform>

            <Canvas>
                <Button Content="â¬…"
                        Style="{StaticResource IconButtonStyle}"
                        Width="30" Height="30"
                        Canvas.Left="-6" Canvas.Top="60"
                        Click="Back_Click"/>

                <Button Content="ðŸ’¾"
                        Style="{StaticResource IconButtonStyle}"
                        Width="30" Height="30"
                        Canvas.Left="25" Canvas.Top="45"
                        Click="Save_Click"/>

                <Button Content="ðŸ“‚"
                        Style="{StaticResource IconButtonStyle}"
                        Width="30" Height="30"
                        Canvas.Left="52" Canvas.Top="19"
                        Click="Load_Click"/>

                <Button Content="âš™ï¸"
                        Style="{StaticResource IconButtonStyle}"
                        Width="30" Height="30"
                        Canvas.Left="62" Canvas.Top="-8"
                        Click="Settings_Click"/>
            </Canvas>
        </Border>
    </Canvas>
</Grid>
</UserControl>
